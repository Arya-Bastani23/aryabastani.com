{"componentChunkName":"component---src-templates-blog-post-js","path":"/blog/integrator-intro/","result":{"data":{"mdx":{"body":"var _excluded = [\"components\"];\nfunction _extends() { _extends = Object.assign ? Object.assign.bind() : function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n/* @jsxRuntime classic */\n/* @jsx mdx */\n\nvar _frontmatter = {\n  \"templateKey\": \"blog-post\",\n  \"published\": true,\n  \"title\": \"Numerical Integration for ODE Estimation\",\n  \"slug\": \"integrator-intro\",\n  \"date\": \"2021-02-03T00:00:00.000Z\",\n  \"featureImage\": \"images/euler_dts.jpg\",\n  \"tags\": [\"Simulation\", \"Numerical Methods\"],\n  \"excerpt\": \"The basics of numerical integration in the context solving ordinary differential equations in Python.\",\n  \"pinned\": false\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n    props = _objectWithoutProperties(_ref, _excluded);\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"h1\", {\n    \"id\": \"what-is-a-numerical-integration\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"What is a Numerical Integration?\", mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#what-is-a-numerical-integration\",\n    \"aria-label\": \"what is a numerical integration permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Numerical integration is the process of utilizing numerical methods to estimate the value of a definite integral and more generally numerical solutions to differential equations. In many cases an equation may have an explicit solution that can be solved for, in which case you should just use that, but for many other equations there may not be and numerical integration can help solve them.\"), mdx(\"p\", null, \"As mentioned before these integrators can see a lot of utility in scientific computation and simulation but I will be focusing on their usage for dynamic simulation today.\"), mdx(\"h1\", {\n    \"id\": \"math-behind-integrators\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Math Behind Integrators\", mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#math-behind-integrators\",\n    \"aria-label\": \"math behind integrators permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"The math behind the three integrators I will be going over today is not that bad, in fact the three methods extend well on each other.\"), mdx(\"h2\", {\n    \"id\": \"euler\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Euler\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#euler\",\n    \"aria-label\": \"euler permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"The Euler integrator is the simplest one that we will consider today. The basic principle is to repeat the following steps.\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Evaluate the derivatives at your current state\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Starting at your current state, follow the derivative over a determined step\")), mdx(\"p\", null, \"Which looks something like this:\"), mdx(\"p\", null, \"$$\\nx_{i+1} = x_i + h \\\\, \\\\dot{x}(x_i) = x_i + k_1\\n$$\"), mdx(\"p\", null, \"Where $h$ is the amount to take a step with on each iteration (something you determine and often called dt). To be a bit more rigorous let's manually compute a few steps of the Euler integration for a function using $h=1$.\"), mdx(\"p\", null, \"$$\\n\\\\dot{x}=2x \\\\text{,} \\\\,\\\\, x(0)=1\\n$$\"), mdx(\"h3\", {\n    \"id\": \"first-step\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"First Step\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#first-step\",\n    \"aria-label\": \"first step permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"$$\\nx(h) = x(0) + h \\\\times \\\\dot{x}(x(0)) = 1 + 1 \\\\times (2 \\\\times 1) = 3\\n$$\"), mdx(\"h3\", {\n    \"id\": \"second-step\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Second Step\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#second-step\",\n    \"aria-label\": \"second step permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"$$\\nx(2h) = x(h) + h \\\\times \\\\dot{x}(x(h)) = 3 + 1 \\\\times (2 \\\\times 3) = 9\\n$$\"), mdx(\"p\", null, \"This differential equation is one we can integrate explicitly so let's compare and see how we did.\"), mdx(\"p\", null, \"$$\\nx(t) = e^{2t}\\n$$\"), mdx(\"p\", null, \"Let's compare the values from the known solution to the results from Euler.\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$t$\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$x(t) = e^{2t}$\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Euler\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$0$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$e^2 \\\\approx 7.38$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$3$\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$2$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$e^4 \\\\approx 54.59$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$9$\")))), mdx(\"p\", null, \"As we can see the results are not very impressive, we'll discuss more about the limitations of euler integration.\"), mdx(\"h2\", {\n    \"id\": \"heun\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Heun\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#heun\",\n    \"aria-label\": \"heun permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"The Heun integrator extends on Euler by adding a second derivative estimate and taking the average of them. The general method is repeating the following steps:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Evaluate the derivatives at your current state\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Compute the change based on following the derivative over the step ($k_1$)\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Evaluate the derivative at the new state estimate from $k_1$ over a step ($k_2$)\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Take the average of the two derivatives and take a step from the current state\")), mdx(\"p\", null, \"This looks like:\"), mdx(\"p\", null, \"$$\\nk_1 = h \\\\, \\\\dot{x}(x_i)\\n$$\"), mdx(\"p\", null, \"$$\\nk_2 = h \\\\, \\\\dot{x}(x_i + k_1)\\n$$\"), mdx(\"p\", null, \"$$\\nx_{i+1} = x_i + 0.5 (k_1 + k_2)\\n$$\"), mdx(\"p\", null, \"Following the same function as prior let's manually compute two steps.\"), mdx(\"h3\", {\n    \"id\": \"first-step-1\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"First Step\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#first-step-1\",\n    \"aria-label\": \"first step 1 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"$$\\nk_1 = h \\\\, \\\\dot{x}(x(0)) = 1 \\\\times (2\\\\times1) = 2\\n$$\"), mdx(\"p\", null, \"$$\\nk_2 = h \\\\, \\\\dot{x}(x(0) + k_1) =  1\\\\times(2\\\\times(1+2)) = 6\\n$$\"), mdx(\"p\", null, \"$$\\nx(h) = x(0) + 0.5 (k_1 + k_2) = 1 + 0.5(2+6) = 5\\n$$\"), mdx(\"h3\", {\n    \"id\": \"second-step-1\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Second Step\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#second-step-1\",\n    \"aria-label\": \"second step 1 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Let's go ahead and see how the Heun integrator stacks up against the Euler and true results.\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$t$\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$x(t) = e^{2t}$\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Euler\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Heun\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$0$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$e^2 \\\\approx 7.38$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$3$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$5$\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$2$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$e^4 \\\\approx 54.59$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$9$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$25$\")))), mdx(\"p\", null, \"As we can see it's still not doing great but it's closer than Euler.\"), mdx(\"h2\", {\n    \"id\": \"4th-order-runge-kutta-rk4\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"4th Order Runge-Kutta (RK4)\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#4th-order-runge-kutta-rk4\",\n    \"aria-label\": \"4th order runge kutta rk4 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"The RK4 integrator extends on both Euler and Heun by computing 4 estimates of the required changes and taking a weighted average of them based on the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.wikidata.org/wiki/Property:P8558\",\n    \"target\": \"_self\",\n    \"rel\": \"nofollow\"\n  }, \"butcher tableau\"), \".\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Evaluate the derivatives at your current state over time step (k1)\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Evaluate the derivatives at the current state advanced by half of k1 (k2)\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Evaluate the derivatives at the current state advanced by half of k2 (k3)\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Evaluate the derivatives at the current state advanced by a full step of k3 (k4)\")), mdx(\"p\", null, \"This looks like:\"), mdx(\"p\", null, \"$$\\nk_1 = h \\\\, \\\\dot{x}(x_i)\\n$$\"), mdx(\"p\", null, \"$$\\nk_2 = h \\\\, \\\\dot{x}(x_i + 0.5 \\\\times k_1)\\n$$\"), mdx(\"p\", null, \"$$\\nk_3 = h \\\\, \\\\dot{x}(x_i + 0.5 \\\\times k_2)\\n$$\"), mdx(\"p\", null, \"$$\\nk_4 = h \\\\, \\\\dot{x}(x_i + k_3)\\n$$\"), mdx(\"p\", null, \"$$\\nx_{i+1} = x_i + \\\\frac{1}{6} (k_1 + 2k_2 + 2k_3 + k4)\\n$$\"), mdx(\"p\", null, \"Following the same function as prior let's manually compute two steps.\"), mdx(\"h3\", {\n    \"id\": \"first-step-2\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"First Step\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#first-step-2\",\n    \"aria-label\": \"first step 2 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"$$\\nk_1 = h \\\\, \\\\dot{x}(x(0)) = 1 \\\\times (2\\\\times1) = 2\\n$$\"), mdx(\"p\", null, \"$$\\nk_2 = h \\\\, \\\\dot{x}(x(0) + 0.5 \\\\times k_1)\\n$$\"), mdx(\"p\", null, \"$$\\n= 1 \\\\times (2 \\\\times (1+0.5 \\\\times 2)) = 4\\n$$\"), mdx(\"p\", null, \"$$\\nk_3 = h \\\\, \\\\dot{x}(x(0) + 0.5 \\\\times k_2)\\n$$\"), mdx(\"p\", null, \"$$\\n= 1 \\\\times (2 \\\\times (1+0.5 \\\\times 4)) = 6\\n$$\"), mdx(\"p\", null, \"$$\\nk_4 = h \\\\, \\\\dot{x}(x(0) + k_3)\\n$$\"), mdx(\"p\", null, \"$$\\n= 1 \\\\times (2 \\\\times (1+6)) = 14\\n$$\"), mdx(\"p\", null, \"$$\\nx(h) = x(0) + \\\\frac{1}{6} (k_1 + 2k_2 + 2k_3 + k4)\\n$$\"), mdx(\"p\", null, \"$$\\n= \\\\frac{1}{6} (2+2\\\\times8+2\\\\times4+6) = 7\\n$$\"), mdx(\"h3\", {\n    \"id\": \"second-step-2\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Second Step\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#second-step-2\",\n    \"aria-label\": \"second step 2 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"$$\\nk_1 = h \\\\, \\\\dot{x}(x(h)) = 1 \\\\times (2\\\\times7) = 14\\n$$\"), mdx(\"p\", null, \"$$\\nk_2 = h \\\\, \\\\dot{x}(x(h) + 0.5 \\\\times k_1)\\n$$\"), mdx(\"p\", null, \"$$\\n= 1 \\\\times (2 \\\\times (7+0.5 \\\\times 14)) = 28\\n$$\"), mdx(\"p\", null, \"$$\\nk_3 = h \\\\, \\\\dot{x}(x(h) + 0.5 \\\\times k_2)\\n$$\"), mdx(\"p\", null, \"$$\\n= 1 \\\\times (2 \\\\times (7+0.5 \\\\times 28)) = 42\\n$$\"), mdx(\"p\", null, \"$$\\nk_4 = h \\\\, \\\\dot{x}(x(h) + k_3)\\n$$\"), mdx(\"p\", null, \"$$\\n= 1 \\\\times (2 \\\\times (7+42)) = 98\\n$$\"), mdx(\"p\", null, \"$$\\nx(2h) = x(h) + \\\\frac{1}{6} (k_1 + 2k_2 + 2k_3 + k4)\\n$$\"), mdx(\"p\", null, \"$$\\n= \\\\frac{1}{6} (14+2\\\\times28+2\\\\times42+98) = 49\\n$$\"), mdx(\"p\", null, \"Let's go ahead and see how the RK4 integrator stacks up against the Euler, Heun, and true results.\"), mdx(\"table\", null, mdx(\"thead\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"thead\"\n  }, mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$t$\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$x(t) = e^{2t}$\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Euler\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"Heun\"), mdx(\"th\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"RK4\"))), mdx(\"tbody\", {\n    parentName: \"table\"\n  }, mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$0$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$1$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$e^2 \\\\approx 7.38$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$3$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$5$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$7$\")), mdx(\"tr\", {\n    parentName: \"tbody\"\n  }, mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$2$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$e^4 \\\\approx 54.59$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$9$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$25$\"), mdx(\"td\", {\n    parentName: \"tr\",\n    \"align\": null\n  }, \"$49$\")))), mdx(\"p\", null, \"As we can see the RK4 did a much better job estimating the true value! The steps that we took were quite course for this particular equation but we'll see later on that the trend of the RK4 clearly beating the other two integrators continues into the implementation.\"), mdx(\"h1\", {\n    \"id\": \"example-implementation\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Example Implementation\", mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#example-implementation\",\n    \"aria-label\": \"example implementation permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Let's apply three common numerical integrators to an undamped and unforced spring mass system. Let's first detail the differential equation for this system, it is as follows:\"), mdx(\"p\", null, \"$$\\nm \\\\ddot{x}+kx=0 \\\\rightarrow m \\\\ddot{x}=-kx\\n$$\"), mdx(\"p\", null, \"Where $m$ is the mass of the object, $k$ is the spring rate, $x$ is the term we desire to track the position of the mass, and $\\\\ddot{x}$ is the acceleration of the mass. Let's start by defining this differential equation as a Python function that returns a $\", \"[1 \\\\times 2]\", \"$ matrix that contains the velocity $\\\\dot{x}$ and the acceleration $\\\\ddot{x}$.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"def eval_derivs(X):\\n    # Constants\\n    m = 1\\n    k = 1\\n\\n    # New state derivative vector [xdot and xdoubledot]\\n    xdd = -(k/m) * X[0]\\n    Xdot = np.array([X[1], xdd])\\n    return Xdot\\n\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"With this structure we can do both integrations in one step! As we are starting with $\\\\ddot{x}$ and we are trying to integrate up two power to just $x$ we need to integrate the acceleration $\\\\ddot{x}$ to get velocity $\\\\dot{x}$ and integrate once more to get $x$. With this matrix setup the matrix addition will update both terms at once!\")), mdx(\"h2\", {\n    \"id\": \"euler-integration\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Euler Integration\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#euler-integration\",\n    \"aria-label\": \"euler integration permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Next we can implement the function that applies an Euler integration step to solve for the velocity and position of the mass. As a reminder this is the first of the integrators mentioned prior and only relies on the rate at that instant.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"def euler(X, dt, evaluate):\\n    \\\"\\\"\\\"\\n    Euler Integration Step\\n    Inputs:\\n        X: State vector at the current point\\n        dt: Integration step (often called h)\\n        evaluate: Function to evaluate for derivative terms\\n    Returns:\\n        X_new: Updated state vector\\n    \\\"\\\"\\\"\\n    # Calculate Terms\\n    k1 = dt * evaluate(X)\\n\\n    # Update X\\n    X_new = X + k1\\n    return X_new\\n\")), mdx(\"p\", null, \"Which takes in a series of arguments and computes the estimated state one step ahead, notably the evaluate argument is where we can pass in the function, \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"eval_derivs\"), \", for our equation derivative. This function only computes one step when called so we need to wrap it with an iterator to advance us through multiple steps. This can be done as follows:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"# Initial conditions\\nX = np.array([1,0])\\n# Time step\\ndt = 0.25\\n# End time\\nt = 10\\niters = int(t/dt)\\n\\n# Data structure for results\\nD = np.zeros((iters+1, 2))\\nD[0] = X\\nT = np.linspace(0,t, iters+1)\\n\\n# Iterate over number of steps\\nfor i in range(iters):\\n    # Compute an integration step and save\\n    D[i+1] = euler(D[i], dt, eval_derivs)\\n\")), mdx(\"p\", null, \"This chunk of code sets up our initial conditions for our system ($x=1$ and $\\\\dot{x}=0$), the step to advance over, the total time, and a matrix of size $\", \"[(\\\\text{\", \"#\", \" Steps}+1) \\\\times 2]\", \"$ to store $x$ and $\\\\dot{x}$ over time. Although I mentioned that numerical integrators can be used to integrate functions with unknown explicit solutions this is not one of them so we can use the true solution to see how well our integrator works!\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/3e2fa90cad00f284aca3d55caf7c31d5/111a0/euler_example.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lhQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAIDAAAAAAAAAAAAAAAAAAABESBh/9oACAEBAAE/ISMFT//aAAwDAQACAAMAAAAQkM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAwEAAwAAAAAAAAAAAAABABEhQTFRcf/aAAgBAQABPxDq8gDQHwgoqVrsLb3wwKPc/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Euler integration\",\n    \"title\": \"Euler integration\",\n    \"src\": \"/static/3e2fa90cad00f284aca3d55caf7c31d5/6c738/euler_example.jpg\",\n    \"srcSet\": [\"/static/3e2fa90cad00f284aca3d55caf7c31d5/73b64/euler_example.jpg 300w\", \"/static/3e2fa90cad00f284aca3d55caf7c31d5/3ad8d/euler_example.jpg 600w\", \"/static/3e2fa90cad00f284aca3d55caf7c31d5/6c738/euler_example.jpg 1200w\", \"/static/3e2fa90cad00f284aca3d55caf7c31d5/8b34c/euler_example.jpg 1800w\", \"/static/3e2fa90cad00f284aca3d55caf7c31d5/111a0/euler_example.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Euler integration\"), \"\\n  \")), mdx(\"p\", null, \"The result is not the best but we can lower the step to improve the accuracy.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/30cd790b6845262edc1d8f6c3c3cf9e8/111a0/euler_dts.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3paAf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABoQAAMAAwEAAAAAAAAAAAAAAAABERAhMXH/2gAIAQEAAT8hflI+xCJu5//aAAwDAQACAAMAAAAQIM//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAbEAEAAgMBAQAAAAAAAAAAAAABABEhMVFhkf/aAAgBAQABPxCytAcYFgfhv7NNV5O7MLbzpgUT/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Euler integration with varying time steps\",\n    \"title\": \"Euler integration with varying time steps\",\n    \"src\": \"/static/30cd790b6845262edc1d8f6c3c3cf9e8/6c738/euler_dts.jpg\",\n    \"srcSet\": [\"/static/30cd790b6845262edc1d8f6c3c3cf9e8/73b64/euler_dts.jpg 300w\", \"/static/30cd790b6845262edc1d8f6c3c3cf9e8/3ad8d/euler_dts.jpg 600w\", \"/static/30cd790b6845262edc1d8f6c3c3cf9e8/6c738/euler_dts.jpg 1200w\", \"/static/30cd790b6845262edc1d8f6c3c3cf9e8/8b34c/euler_dts.jpg 1800w\", \"/static/30cd790b6845262edc1d8f6c3c3cf9e8/111a0/euler_dts.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Euler integration with varying time steps\"), \"\\n  \")), mdx(\"p\", null, \"Although reducing the time step helps the result is still pretty bad, but why is this the case? As it turns out the simplicity of Euler integration, while convenient, leaves a lot to be desired in terms of accuracy. The single estimate of the rates to predict further steps does not allow the integrator to handle concave/convex sections without inducing error. To better understand this let's take a look at 2 coarse integration steps using Euler on this function.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/3aaab6d6d42b3a9368b881cb410ebcd6/111a0/euler_vector.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd6bQwD/xAAWEAADAAAAAAAAAAAAAAAAAAAAESD/2gAIAQEAAQUCFP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAQUBAAAAAAAAAAAAAAAAAQAQESExcf/aAAgBAQABPyEiSjHK40Wtb//aAAwDAQACAAMAAAAQU8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAcEAEAAgEFAAAAAAAAAAAAAAABABExECFBUWH/2gAIAQEAAT8QBhxXcBFkDfqGIrcMLsXzWNP/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Euler integration step close up\",\n    \"title\": \"Euler integration step close up\",\n    \"src\": \"/static/3aaab6d6d42b3a9368b881cb410ebcd6/6c738/euler_vector.jpg\",\n    \"srcSet\": [\"/static/3aaab6d6d42b3a9368b881cb410ebcd6/73b64/euler_vector.jpg 300w\", \"/static/3aaab6d6d42b3a9368b881cb410ebcd6/3ad8d/euler_vector.jpg 600w\", \"/static/3aaab6d6d42b3a9368b881cb410ebcd6/6c738/euler_vector.jpg 1200w\", \"/static/3aaab6d6d42b3a9368b881cb410ebcd6/8b34c/euler_vector.jpg 1800w\", \"/static/3aaab6d6d42b3a9368b881cb410ebcd6/111a0/euler_vector.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Euler integration step close up\"), \"\\n  \")), mdx(\"p\", null, \"Consider the first arrow, at $t=0$ the value of $\\\\dot{x}=0$ and so integrating that with Euler we get the following:\"), mdx(\"p\", null, \"$$\\nx \\\\times {2} = x \\\\times {1} + \\\\dot{x} \\\\times \\\\text{h} = 1 + 0 \\\\times \\\\text{h} = 1\\n$$\"), mdx(\"p\", null, \"So no matter what h is the very first step of this integration will never change the values of $x$. This is a problem because we can see that the mass does start moving and $\\\\dot{x}$ no longer becomes zero right after $t=0$. This is where the multiple terms of the Heun and RK4 integrator can help a lot!\"), mdx(\"h2\", {\n    \"id\": \"heun-integration\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Heun Integration\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#heun-integration\",\n    \"aria-label\": \"heun integration permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"We can follow the same steps we took for Euler and all we need to do now is implement \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"heun\"), \" in the code and pass that in as the integrator in our iterator, that looks like this:\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"def heun(X, dt, evaluate):\\n    \\\"\\\"\\\"\\n    Heun's Method Integration Step\\n    Inputs:\\n        X: State vector at the current point\\n        dt: Integration step (often called h)\\n        evaluate: Function to evaluate for derivative terms\\n    Returns:\\n        X_new: Updated state vector\\n    \\\"\\\"\\\"\\n    # Calculate Terms\\n    k1 = dt * evaluate(X)\\n    k2 = dt * evaluate(X + k1)\\n\\n    # Update X\\n    X_new = X + (1/2.)*(k1 + k2)\\n    return X_new\\n\")), mdx(\"p\", null, \"And for the integrator all we need to change is what integrator function call is used.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python{high={4}}\"\n  }, \"# Iterate over number of steps\\nfor i in range(iters):\\n    # Compute an integration step and save\\n    D[i+1] = heun(D[i], dt, eval_derivs)\\n\")), mdx(\"p\", null, \"The first term k1 is identical to Euler but we introduce k2 to get an estimate of the rates from \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"evaluate\"), \" at the result of the Euler step. We then take an average to estimate what the average rate from the start to end should be. This yields the following results:\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/8f0f22047ad0ba25f996ff7d5eaaf26e/111a0/heun_example.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lhQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABcQAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQEAAT8hREIm/wD/2gAMAwEAAgADAAAAEBDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhABAAMBAQEAAAAAAAAAAAAAAQARITFBUf/aAAgBAQABPxAWq/agWgHmQUVPVLuwFEvmQKO3P//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Heun integration\",\n    \"title\": \"Heun integration\",\n    \"src\": \"/static/8f0f22047ad0ba25f996ff7d5eaaf26e/6c738/heun_example.jpg\",\n    \"srcSet\": [\"/static/8f0f22047ad0ba25f996ff7d5eaaf26e/73b64/heun_example.jpg 300w\", \"/static/8f0f22047ad0ba25f996ff7d5eaaf26e/3ad8d/heun_example.jpg 600w\", \"/static/8f0f22047ad0ba25f996ff7d5eaaf26e/6c738/heun_example.jpg 1200w\", \"/static/8f0f22047ad0ba25f996ff7d5eaaf26e/8b34c/heun_example.jpg 1800w\", \"/static/8f0f22047ad0ba25f996ff7d5eaaf26e/111a0/heun_example.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Heun integration\"), \"\\n  \")), mdx(\"p\", null, \"This looks great compared to Euler! We still can see some error produced near the end but it's much better. Let's see what we can achieve with coarser and finer steps.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/2904788c497bad44c1b852c6bc862503/111a0/heun_dts.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe9NQoP/xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAZEAACAwEAAAAAAAAAAAAAAAAAARARMUH/2gAIAQEAAT8h6UtFhUI//9oADAMBAAIAAwAAABAQz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABgQAQEBAQEAAAAAAAAAAAAAAAERACEx/9oACAEBAAE/EIKvRZpMAFnMZFszV77gol4cwhLd/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Heun integration with varying time steps\",\n    \"title\": \"Heun integration with varying time steps\",\n    \"src\": \"/static/2904788c497bad44c1b852c6bc862503/6c738/heun_dts.jpg\",\n    \"srcSet\": [\"/static/2904788c497bad44c1b852c6bc862503/73b64/heun_dts.jpg 300w\", \"/static/2904788c497bad44c1b852c6bc862503/3ad8d/heun_dts.jpg 600w\", \"/static/2904788c497bad44c1b852c6bc862503/6c738/heun_dts.jpg 1200w\", \"/static/2904788c497bad44c1b852c6bc862503/8b34c/heun_dts.jpg 1800w\", \"/static/2904788c497bad44c1b852c6bc862503/111a0/heun_dts.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Heun integration with varying time steps\"), \"\\n  \")), mdx(\"p\", null, \"While the results are appreciably better than Euler we still see that we need to make the step quite small to get reasonable results. Going back to the lack of handling concave/convex regions lets look at the closeup.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/535feb3963f27af53ef30aed10b41869/111a0/heun_vector.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd6bQwD/xAAWEAADAAAAAAAAAAAAAAAAAAAAESD/2gAIAQEAAQUCFP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAHBAAAQMFAAAAAAAAAAAAAAAAAQAQESExQXGR/9oACAEBAAE/ISJK41loqrt//9oADAMBAAIAAwAAABBDz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABoQAQADAQEBAAAAAAAAAAAAAAEAESExEHH/2gAIAQEAAT8QwFeRFhdzbAfEORWhlJReOZ5//9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Heun integration step close up\",\n    \"title\": \"Heun integration step close up\",\n    \"src\": \"/static/535feb3963f27af53ef30aed10b41869/6c738/heun_vector.jpg\",\n    \"srcSet\": [\"/static/535feb3963f27af53ef30aed10b41869/73b64/heun_vector.jpg 300w\", \"/static/535feb3963f27af53ef30aed10b41869/3ad8d/heun_vector.jpg 600w\", \"/static/535feb3963f27af53ef30aed10b41869/6c738/heun_vector.jpg 1200w\", \"/static/535feb3963f27af53ef30aed10b41869/8b34c/heun_vector.jpg 1800w\", \"/static/535feb3963f27af53ef30aed10b41869/111a0/heun_vector.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Heun integration step close up\"), \"\\n  \")), mdx(\"p\", null, \"The first step is nearly perfect but we can see that the second step overestimates the rates and so we over correct, let's see what the additional two terms of RK4 can do.\"), mdx(\"h2\", {\n    \"id\": \"rk4\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"RK4\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#rk4\",\n    \"aria-label\": \"rk4 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Similarly to Heun, all we need to do is implement \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"rk4\"), \" and change the integrator in the iterator.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"def rk4(X, dt, evaluate):\\n    \\\"\\\"\\\"\\n    Runge-Kutta 4th Order Integration Step\\n    Inputs:\\n        X: State vector at the current point\\n        dt: Integration step (often called h)\\n        evaluate: Function to evaluate for derivative terms\\n    Returns:\\n        X_new: Updated state vector\\n    \\\"\\\"\\\"\\n    # Calculate Terms\\n    k1 = dt * evaluate(X)\\n    k2 = dt * evaluate(X + 0.5*k1)\\n    k3 = dt * evaluate(X + 0.5*k2)\\n    k4 = dt * evaluate(X + k3)\\n\\n    # Update X\\n    X_new = X + (1/6.)*(k1 + 2*k2 + 2*k3 + k4)\\n    return X_new\\n\")), mdx(\"p\", null, \"We start with k1 identical to Euler but then it gets interesting, as a reminder the terms can be interpreted as:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"k1\"), \": the rates when the derivatives are evaluated at the current state\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"k2\"), \": the rates when the derivatives are evaluated at half the step using the initial rate estimate\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"k3\"), \": the rates when the derivatives are evaluated at half the step using k2\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"strong\", {\n    parentName: \"li\"\n  }, \"k4\"), \": the rates when the derivatives are evaluated at a full the step using k3\")), mdx(\"p\", null, \"The rates are combined using a weighted average based on the \", mdx(\"a\", {\n    parentName: \"p\",\n    \"href\": \"https://www.wikidata.org/wiki/Property:P8558\",\n    \"target\": \"_self\",\n    \"rel\": \"nofollow\"\n  }, \"butcher tableau\"), \". All we do now is update the integrator call in our iterator.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python{high={4}}\"\n  }, \"# Iterate over number of steps\\nfor i in range(iters):\\n    # Compute an integration step and save\\n    D[i+1] = rk4(D[i], dt, eval_derivs)\\n\")), mdx(\"p\", null, \"Let's see how well this performs!\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/dbc53cdd42845152f94807eaee008c0c/111a0/rk4_example.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lhQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABcQAAMBAAAAAAAAAAAAAAAAAAABERD/2gAIAQEAAT8hREIm/wD/2gAMAwEAAgADAAAAEBDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAQEAAgMAAAAAAAAAAAAAAREAITFBUXH/2gAIAQEAAT8QFVfeCqE+YQm8oy84FEvXGCHd3//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"RK4 integration\",\n    \"title\": \"RK4 integration\",\n    \"src\": \"/static/dbc53cdd42845152f94807eaee008c0c/6c738/rk4_example.jpg\",\n    \"srcSet\": [\"/static/dbc53cdd42845152f94807eaee008c0c/73b64/rk4_example.jpg 300w\", \"/static/dbc53cdd42845152f94807eaee008c0c/3ad8d/rk4_example.jpg 600w\", \"/static/dbc53cdd42845152f94807eaee008c0c/6c738/rk4_example.jpg 1200w\", \"/static/dbc53cdd42845152f94807eaee008c0c/8b34c/rk4_example.jpg 1800w\", \"/static/dbc53cdd42845152f94807eaee008c0c/111a0/rk4_example.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"RK4 integration\"), \"\\n  \")), mdx(\"p\", null, \"Wow! The rk4 performs extremely well for the same time step as used prior, let's see what this looks like for other time steps.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/e34b49f343b5f75aaabeca694200090c/111a0/rk4_dts.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3pRQf//EABYQAAMAAAAAAAAAAAAAAAAAAAARIP/aAAgBAQABBQIU/wD/xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAYEAEAAwEAAAAAAAAAAAAAAAAAARARMf/aAAgBAQABPyFhHGVD/9oADAMBAAIAAwAAABBwz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQEBAQEBAAAAAAAAAAAAAAERACFBYf/aAAgBAQABPxAKt6LNBoB2cxkWzewUvcCiXhzCEt+7/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"RK4 integration with varying time steps\",\n    \"title\": \"RK4 integration with varying time steps\",\n    \"src\": \"/static/e34b49f343b5f75aaabeca694200090c/6c738/rk4_dts.jpg\",\n    \"srcSet\": [\"/static/e34b49f343b5f75aaabeca694200090c/73b64/rk4_dts.jpg 300w\", \"/static/e34b49f343b5f75aaabeca694200090c/3ad8d/rk4_dts.jpg 600w\", \"/static/e34b49f343b5f75aaabeca694200090c/6c738/rk4_dts.jpg 1200w\", \"/static/e34b49f343b5f75aaabeca694200090c/8b34c/rk4_dts.jpg 1800w\", \"/static/e34b49f343b5f75aaabeca694200090c/111a0/rk4_dts.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"RK4 integration with varying time steps\"), \"\\n  \")), mdx(\"p\", null, \"Even at the coarsest time step we get a very usable result! This is great because for a coarser timestep we can save on compute (even if each step has more compute involved when compared to Euler/Heun).\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/9840bec90ce56391cd090215fd10b9ad/111a0/rk4_vector.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAd6bQwD/xAAWEAADAAAAAAAAAAAAAAAAAAAAESD/2gAIAQEAAQUCFP8A/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGxAAAQQDAAAAAAAAAAAAAAAAAQAQESExcYH/2gAIAQEAAT8hIko8aaLWW//aAAwDAQACAAMAAAAQU8//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAEAAwEBAQAAAAAAAAAAAAABABEhMRBh/9oACAEBAAE/EMFXkHNw9AX8YcitDNsKVdc8/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"RK4 integration step close up\",\n    \"title\": \"RK4 integration step close up\",\n    \"src\": \"/static/9840bec90ce56391cd090215fd10b9ad/6c738/rk4_vector.jpg\",\n    \"srcSet\": [\"/static/9840bec90ce56391cd090215fd10b9ad/73b64/rk4_vector.jpg 300w\", \"/static/9840bec90ce56391cd090215fd10b9ad/3ad8d/rk4_vector.jpg 600w\", \"/static/9840bec90ce56391cd090215fd10b9ad/6c738/rk4_vector.jpg 1200w\", \"/static/9840bec90ce56391cd090215fd10b9ad/8b34c/rk4_vector.jpg 1800w\", \"/static/9840bec90ce56391cd090215fd10b9ad/111a0/rk4_vector.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"RK4 integration step close up\"), \"\\n  \")), mdx(\"p\", null, \"This is no surprise given the prior plots but the close up shows the steps landing almost exactly on the true function.\"), mdx(\"h1\", {\n    \"id\": \"damped-spring-mass-oscillator--error-analysis\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Damped Spring Mass Oscillator & Error Analysis\", mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#damped-spring-mass-oscillator--error-analysis\",\n    \"aria-label\": \"damped spring mass oscillator  error analysis permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"With this example we will introduce a damping term and show how we would write each step but also dive a bit more into the error analysis of these methods. We will now be integrating the following:\"), mdx(\"p\", null, \"$$\\nm \\\\ddot{x}+kx+c\\\\dot{x}=0 \\\\rightarrow m \\\\ddot{x}=-kx-c \\\\dot{x}\\n$$\"), mdx(\"p\", null, \"First we need to redefine our \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"eval_derivs\"), \" function for this new differential equation.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"def eval_derivs(X):\\n    # Constants\\n    m = 2\\n    k = 10\\n    c = 2\\n\\n    # New state derivative vector [xdot and xdoubledot]\\n    xdd = -(k/m) * X[0] - (c/m) * X[1]\\n    Xdot = np.array([X[1], xdd])\\n    return Xdot\\n\")), mdx(\"p\", null, \"Now we just need to call the integrators within the iterator as prior, we'll also be using the same initial condition. To refresh here is what this looks like again.\"), mdx(\"pre\", null, mdx(\"code\", {\n    parentName: \"pre\",\n    \"className\": \"language-python\"\n  }, \"# Initial conditions\\nX = np.array([1,0])\\n# Time step\\ndt = 0.25\\n# End time\\nt = 10\\niters = int(t/dt)\\n\\n# Data structure for results\\nD = np.zeros((iters+1, 2))\\nD[0] = X\\nT = np.linspace(0,t, iters+1)\\n\\n# Iterate over number of steps\\nfor i in range(iters):\\n    # Compute an integration step and save\\n    D[i+1] = euler(D[i], dt, eval_derivs)\\n\")), mdx(\"p\", null, \"No changes need to be made to our integrators as they will operate the same as before.\"), mdx(\"h2\", {\n    \"id\": \"euler-1\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Euler\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#euler-1\",\n    \"aria-label\": \"euler 1 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Below are the results for Euler integration on this damped oscillator.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/71e51684ff0763a38f523248beba734b/111a0/euler_damped.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lhQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAAEFAAAAAAAAAAAAAAAAAAABICFBUf/aAAgBAQABPyGyMEZ//9oADAMBAAIAAwAAABAQz//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABkQAQADAQEAAAAAAAAAAAAAAAEAESExUf/aAAgBAQABPxBNMAcBfk4la0wtvePkCif/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Euler integration\",\n    \"title\": \"Euler integration\",\n    \"src\": \"/static/71e51684ff0763a38f523248beba734b/6c738/euler_damped.jpg\",\n    \"srcSet\": [\"/static/71e51684ff0763a38f523248beba734b/73b64/euler_damped.jpg 300w\", \"/static/71e51684ff0763a38f523248beba734b/3ad8d/euler_damped.jpg 600w\", \"/static/71e51684ff0763a38f523248beba734b/6c738/euler_damped.jpg 1200w\", \"/static/71e51684ff0763a38f523248beba734b/8b34c/euler_damped.jpg 1800w\", \"/static/71e51684ff0763a38f523248beba734b/111a0/euler_damped.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Euler integration\"), \"\\n  \"), \"\\n\", mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/57dc3002c2a3b07ab1eb3678e257090b/111a0/euler_damped_error.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3VAD/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAQUBAAAAAAAAAAAAAAAAAAERITFhQf/aAAgBAQABPyHpIlDaNokH/9oADAMBAAIAAwAAABDAD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABwQAQEBAAEFAAAAAAAAAAAAAAERACFBUWGBkf/aAAgBAQABPxBRXCt87l0nrOh1CyLq7vmETf/Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Euler integration error\",\n    \"title\": \"Euler integration error\",\n    \"src\": \"/static/57dc3002c2a3b07ab1eb3678e257090b/6c738/euler_damped_error.jpg\",\n    \"srcSet\": [\"/static/57dc3002c2a3b07ab1eb3678e257090b/73b64/euler_damped_error.jpg 300w\", \"/static/57dc3002c2a3b07ab1eb3678e257090b/3ad8d/euler_damped_error.jpg 600w\", \"/static/57dc3002c2a3b07ab1eb3678e257090b/6c738/euler_damped_error.jpg 1200w\", \"/static/57dc3002c2a3b07ab1eb3678e257090b/8b34c/euler_damped_error.jpg 1800w\", \"/static/57dc3002c2a3b07ab1eb3678e257090b/111a0/euler_damped_error.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Euler integration error\"), \"\\n  \")), mdx(\"p\", null, \"This is hardly a result and so this integrator is worthless at this timestep. The error analysis obviously agrees as visually it's apparent already.\"), mdx(\"h2\", {\n    \"id\": \"heun-1\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Heun\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#heun-1\",\n    \"aria-label\": \"heun 1 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Below are the results for Heun integration on this damped oscillator.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/1b52da44405cc56d4d594795f8a1f77e/111a0/heun_damped.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lhQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAMBAQAAAAAAAAAAAAAAAAABERBR/9oACAEBAAE/ISLgib//2gAMAwEAAgADAAAAEBDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgMBAQAAAAAAAAAAAAAAAREAITFRgf/aAAgBAQABPxAaXbMAMV8EFBX7AmGBl3h5AEJ//9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Heun integration\",\n    \"title\": \"Heun integration\",\n    \"src\": \"/static/1b52da44405cc56d4d594795f8a1f77e/6c738/heun_damped.jpg\",\n    \"srcSet\": [\"/static/1b52da44405cc56d4d594795f8a1f77e/73b64/heun_damped.jpg 300w\", \"/static/1b52da44405cc56d4d594795f8a1f77e/3ad8d/heun_damped.jpg 600w\", \"/static/1b52da44405cc56d4d594795f8a1f77e/6c738/heun_damped.jpg 1200w\", \"/static/1b52da44405cc56d4d594795f8a1f77e/8b34c/heun_damped.jpg 1800w\", \"/static/1b52da44405cc56d4d594795f8a1f77e/111a0/heun_damped.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Heun integration\"), \"\\n  \"), \"\\n\", mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/0b1473fb937fc1d9304e4d896967a968/111a0/heun_damped_error.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3VFB/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGhAAAgMBAQAAAAAAAAAAAAAAAAERMWEhgf/aAAgBAQABPyF2eCojSNFw/9oADAMBAAIAAwAAABDwD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAAICAwEAAAAAAAAAAAAAAAABETEhQVGx/9oACAEBAAE/EGbZZvg6y3hGlDk9Nk+hIQf/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Heun integration error\",\n    \"title\": \"Heun integration error\",\n    \"src\": \"/static/0b1473fb937fc1d9304e4d896967a968/6c738/heun_damped_error.jpg\",\n    \"srcSet\": [\"/static/0b1473fb937fc1d9304e4d896967a968/73b64/heun_damped_error.jpg 300w\", \"/static/0b1473fb937fc1d9304e4d896967a968/3ad8d/heun_damped_error.jpg 600w\", \"/static/0b1473fb937fc1d9304e4d896967a968/6c738/heun_damped_error.jpg 1200w\", \"/static/0b1473fb937fc1d9304e4d896967a968/8b34c/heun_damped_error.jpg 1800w\", \"/static/0b1473fb937fc1d9304e4d896967a968/111a0/heun_damped_error.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"Heun integration error\"), \"\\n  \")), mdx(\"p\", null, \"Heun does much better than Euler but seems to produce a bit of a phase shift or lag in the results. The error analysis shows this did much better but there is much more to be desired still (especially for percent error).\"), mdx(\"h2\", {\n    \"id\": \"rk4-1\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"RK4\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#rk4-1\",\n    \"aria-label\": \"rk4 1 permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Below are the results for RK4 integration on this damped oscillator.\"), mdx(\"p\", null, mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/5bd79acf76e25a341ef0a80305900502/111a0/rk4_damped.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3lhQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABgQAAMBAQAAAAAAAAAAAAAAAAABERBR/9oACAEBAAE/ISLgib//2gAMAwEAAgADAAAAEBDP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGhAAAgMBAQAAAAAAAAAAAAAAAREAITFRgf/aAAgBAQABPxAaXdwAxXwQUFfsCYYGXeHkAQn/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"RK4 integration\",\n    \"title\": \"RK4 integration\",\n    \"src\": \"/static/5bd79acf76e25a341ef0a80305900502/6c738/rk4_damped.jpg\",\n    \"srcSet\": [\"/static/5bd79acf76e25a341ef0a80305900502/73b64/rk4_damped.jpg 300w\", \"/static/5bd79acf76e25a341ef0a80305900502/3ad8d/rk4_damped.jpg 600w\", \"/static/5bd79acf76e25a341ef0a80305900502/6c738/rk4_damped.jpg 1200w\", \"/static/5bd79acf76e25a341ef0a80305900502/8b34c/rk4_damped.jpg 1800w\", \"/static/5bd79acf76e25a341ef0a80305900502/111a0/rk4_damped.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"RK4 integration\"), \"\\n  \"), \"\\n\", mdx(\"figure\", {\n    parentName: \"p\",\n    \"className\": \"gatsby-resp-image-figure\",\n    \"style\": {}\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1200px\"\n    }\n  }, \"\\n      \", mdx(\"a\", {\n    parentName: \"span\",\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/b25da8c0a770e079b21b1ccefc348452/111a0/rk4_damped_error.jpg\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }, \"\\n    \", mdx(\"span\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"66.66666666666666%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFwABAQEBAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAe61Cg//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAEFAl//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/AT//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/AT//xAAUEAEAAAAAAAAAAAAAAAAAAAAg/9oACAEBAAY/Al//xAAaEAEAAgMBAAAAAAAAAAAAAAAAAREhMWGB/9oACAEBAAE/IXiNK6rqMP/aAAwDAQACAAMAAAAQUA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAaEAADAQEBAQAAAAAAAAAAAAAAARExIWGh/9oACAEBAAE/EO2ejsjZ/CcYNrxkN3rCRD//2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  }), \"\\n  \", mdx(\"img\", {\n    parentName: \"a\",\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"RK4 integration error\",\n    \"title\": \"RK4 integration error\",\n    \"src\": \"/static/b25da8c0a770e079b21b1ccefc348452/6c738/rk4_damped_error.jpg\",\n    \"srcSet\": [\"/static/b25da8c0a770e079b21b1ccefc348452/73b64/rk4_damped_error.jpg 300w\", \"/static/b25da8c0a770e079b21b1ccefc348452/3ad8d/rk4_damped_error.jpg 600w\", \"/static/b25da8c0a770e079b21b1ccefc348452/6c738/rk4_damped_error.jpg 1200w\", \"/static/b25da8c0a770e079b21b1ccefc348452/8b34c/rk4_damped_error.jpg 1800w\", \"/static/b25da8c0a770e079b21b1ccefc348452/111a0/rk4_damped_error.jpg 2400w\"],\n    \"sizes\": \"(max-width: 1200px) 100vw, 1200px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\",\n    \"decoding\": \"async\"\n  }), \"\\n  \"), \"\\n    \"), \"\\n    \", mdx(\"figcaption\", {\n    parentName: \"figure\",\n    \"className\": \"gatsby-resp-image-figcaption\"\n  }, \"RK4 integration error\"), \"\\n  \")), mdx(\"p\", null, \"RK4 does wonderful here, we can not appreciate much error when looking at the points of the steps. The error analysis shows very small absolute and percent errors. Although this is the case I would still like to point out something interesting about the percent error.\"), mdx(\"h2\", {\n    \"id\": \"error-advice\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Error Advice\", mdx(\"a\", {\n    parentName: \"h2\",\n    \"href\": \"#error-advice\",\n    \"aria-label\": \"error advice permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"It's easy to try to chase down the values for both percent and absolute error but I want to offer some advice on how to perceive errors and determine what is \\\"real\\\". Let's imagine we were tracking the position of a car in a grid using an integrator. Far from the origin (0,0) a small tracking error of 1 meter for example could be a very small error whereas the same tracking error near the origin could be huge!\"), mdx(\"h3\", {\n    \"id\": \"far-case\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Far Case\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#far-case\",\n    \"aria-label\": \"far case permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Let's say the true x position of the car is 400m from the origin with a tracking error of 1m, let's compute the errors. Obviously the absolute error is 1m so let's just compute the percent error.\"), mdx(\"p\", null, \"$$\\n\\\\text{\\\\% Error} = \\\\frac{\\\\text{Error}}{\\\\text{True Value}} \\\\times 100 = \\\\frac{1}{400} \\\\times 100 = 0.25\\\\%\\n$$\"), mdx(\"h3\", {\n    \"id\": \"origin-case\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Origin Case\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#origin-case\",\n    \"aria-label\": \"origin case permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Let's consider the same tracking error but the x position is now 5m. The absolute error is the same in both cases but as we'll see the percent error is very different.\"), mdx(\"p\", null, \"$$\\n\\\\text{\\\\% Error} = \\\\frac{\\\\text{Error}}{\\\\text{True Value}} \\\\times 100 = \\\\frac{1}{5} \\\\times 100 = 20\\\\%\\n$$\"), mdx(\"h3\", {\n    \"id\": \"summary\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Summary\", mdx(\"a\", {\n    parentName: \"h3\",\n    \"href\": \"#summary\",\n    \"aria-label\": \"summary permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"To close the error conversation, it helps to think about what type of error measurement is important. In something like a car where you're concerned about staying in a lane the absolute error is all that matters whereas the percent error could give you a grossly over or unexaggerated idea of how well you're doing. There are other cases where percent error can be more useful such as when the values do not approach a sensitivity point near 0 or when relative comparisons are to be made.\"), mdx(\"h1\", {\n    \"id\": \"further-analysis\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Further Analysis\", mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#further-analysis\",\n    \"aria-label\": \"further analysis permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"This is merely an introduction to using these methods but if there is interest we can extend this material to cover more points such as:\"), mdx(\"ol\", null, mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Estimating error reduction with time step changes and generally more theory on numerical error for the methods\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"Trying other types of ODEs such as ones that are a function of time and not just of prior solutions\"), mdx(\"li\", {\n    parentName: \"ol\"\n  }, \"A higher order example (ex: simulating the flight of a ball in 3d space).\")), mdx(\"h1\", {\n    \"id\": \"conclusion\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, \"Conclusion\", mdx(\"a\", {\n    parentName: \"h1\",\n    \"href\": \"#conclusion\",\n    \"aria-label\": \"conclusion permalink\",\n    \"className\": \"anchor after\"\n  }, mdx(\"svg\", {\n    parentName: \"a\",\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }, mdx(\"path\", {\n    parentName: \"svg\",\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), mdx(\"p\", null, \"Numerical integrators can be fast and flexible solutions to solving difficult ODEs in a programming environment. Although they seem simple in principle much of the difficulty can be in validating the performance of the integrators as we've seen simple integrators struggle with functions with continuously changing derivatives.\"), mdx(\"p\", null, \"I hope you enjoyed and learned something new! Let me know if you have any questions or suggestions for improvements.\"));\n}\n;\nMDXContent.isMDXComponent = true;","frontmatter":{"title":"Numerical Integration for ODE Estimation","date":"February 3rd, 2021","excerpt":"The basics of numerical integration in the context solving ordinary differential equations in Python.","featureImage":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","placeholder":{"fallback":"data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAANABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB3pRQf//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEAAQUCX//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAACD/2gAIAQEABj8CX//EABkQAQEBAAMAAAAAAAAAAAAAAAABEUFhkf/aAAgBAQABPyGu8vqOWo//2gAMAwEAAgADAAAAEAAP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGxABAAMBAAMAAAAAAAAAAAAAAQARIWFBgZH/2gAIAQEAAT8QTuKchZijuvkVlxEvfqDfE0T/2Q=="},"images":{"fallback":{"src":"/static/30cd790b6845262edc1d8f6c3c3cf9e8/3b307/euler_dts.jpg","srcSet":"/static/30cd790b6845262edc1d8f6c3c3cf9e8/d9f52/euler_dts.jpg 200w,\n/static/30cd790b6845262edc1d8f6c3c3cf9e8/0132d/euler_dts.jpg 400w,\n/static/30cd790b6845262edc1d8f6c3c3cf9e8/3b307/euler_dts.jpg 800w,\n/static/30cd790b6845262edc1d8f6c3c3cf9e8/1e618/euler_dts.jpg 1600w","sizes":"(min-width: 800px) 800px, 100vw"},"sources":[]},"width":800,"height":533}}}},"fields":{"path":"/blog/integrator-intro/","readingTime":{"text":"23 min read"}},"tableOfContents":{"items":[{"url":"#what-is-a-numerical-integration","title":"What is a Numerical Integration?"},{"url":"#math-behind-integrators","title":"Math Behind Integrators","items":[{"url":"#euler","title":"Euler"},{"url":"#heun","title":"Heun"},{"url":"#4th-order-runge-kutta-rk4","title":"4th Order Runge-Kutta (RK4)"}]},{"url":"#example-implementation","title":"Example Implementation","items":[{"url":"#euler-integration","title":"Euler Integration"},{"url":"#heun-integration","title":"Heun Integration"},{"url":"#rk4","title":"RK4"}]},{"url":"#damped-spring-mass-oscillator--error-analysis","title":"Damped Spring Mass Oscillator & Error Analysis","items":[{"url":"#euler-1","title":"Euler"},{"url":"#heun-1","title":"Heun"},{"url":"#rk4-1","title":"RK4"},{"url":"#error-advice","title":"Error Advice"}]},{"url":"#further-analysis","title":"Further Analysis"},{"url":"#conclusion","title":"Conclusion"}]}},"site":{"siteMetadata":{"title":"Patrick Youssef"}}},"pageContext":{"post_id":"/blog/integrator-intro/"}},"staticQueryHashes":[]}